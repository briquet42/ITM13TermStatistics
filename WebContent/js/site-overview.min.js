function generateWordsTable(){wordTable=$("#word-list-table").DataTable({dom:"frtip",ajax:"../rest/website/"+siteID+"/words",order:[[1,"desc"]],columns:[{data:"word"},{data:"amount"}],select:"single"})}var barChart,lineChart,siteID,wordTable,startRange,endRange,$chartsSection=$("#charts");$(document).ready(function(){siteID=$("#siteID").val(),generateWordsTable(),getAllWordsForDomain(generateBarChart),getSiteCrawlingStats(),getSubsiteCrawlingStats()});var getSiteCrawlingStats=function(){$.getJSON("../rest/website/"+siteID+"/stats",function(t){var o=t.data[0];void 0!==typeof o&&(void 0!==typeof o.crawlDuration&&$("#crawl-duration").text(o.crawlDuration/1e3+" s"),void 0!==typeof o.avg_article&&$("#avg-article-amount").text(o.avg_article),void 0!==typeof o.analyzeDuration&&$("#analyze-duration").text(o.analyzeDuration/1e3+" s"))})},getSubsiteCrawlingStats=function(){$.getJSON("../rest/website/"+siteID+"/avgword",function(t){var o=t.data[0];void 0!==typeof o&&(void 0!==typeof o.avgwordlength&&$("#avg-word-length").text(o.avgwordlength),void 0!==typeof o.avgwords&&$("#avg-word-amount").text(o.avgwords))})};$("#fromDate").change(function(){if("undefined"!=typeof $(this).val()){var t=$(this).val().split("-");startRange=t[2]+"."+t[1]+"."+t[0],$("#toDate").removeAttr("disabled"),$("#toDate").attr("min",$(this).val())}}),$("#toDate").change(function(){if("undefined"!=typeof $(this).val()){var t=$(this).val().split("-");endRange=t[2]+"."+t[1]+"."+t[0],getAmountsForSiteWithDateRange(startRange,endRange,generateLineChart)}});var getAllWordsForDomain=function(t){$.getJSON("/TermStatistics/rest/website/"+siteID+"/words/10",function(o){$chartsSection.removeClass("overlay"),t(o.data)})},getAmountsForSiteWithDateRange=function(t,o,a){$.getJSON("../rest/website/"+siteID+"/period/"+t+"/"+o,function(t){$chartsSection.removeClass("overlay"),a(t)})},generateBarChart=function(t){var o=[],a=[];$(t).each(function(e){o.push(t[e].word),a.push(t[e].amount)});var e={labels:o,datasets:[{label:"",fillColor:"rgba(22, 160, 133, 0.6)",strokeColor:"rgba(38, 166, 91, 0.4)",pointColor:"rgba(220,220,220,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:a}]},r=$("#bar-chart").get(0).getContext("2d");barChart=new Chart(r).Bar(e)},generateLineChart=function(t){var o=[],a=[],e={legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].strokeColor%>"><%if(datasets[i].label){%><%=datasets[i].label%><%}%></span></li><%}%></ul>'},r=Object.keys(t);$(r).each(function(e,r){var i=[];$(t[r]).each(function(){o.indexOf($(this)[0].date)<0&&o.push($(this)[0].date),i.push($(this)[0].amount)}),a.push(i)});var i=["rgba(38, 166, 91, 0.8)","rgba(34, 167, 240, 0.8)","rgba(219, 10, 91, 0.8)","rgba(108, 122, 137, 0.8)","rgba(207, 0, 15, 0.8)","rgba(247, 202, 24, 0.8)","rgba(242, 38, 19, 0.8)","rgba(154, 18, 179, 0.8)","rgba(249, 105, 14, 0.8)","rgba(34, 49, 63, 0.8)"],l={labels:o,datasets:[{label:r[0],fillColor:"rgba(22, 160, 133, 0.0)",strokeColor:i[0],pointColor:i[0],pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:a[0]},{label:r[1],fillColor:"rgba(22, 160, 133, 0.0)",strokeColor:i[1],pointColor:i[1],pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:a[1]},{label:r[2],fillColor:"rgba(22, 160, 133, 0.0)",strokeColor:i[2],pointColor:i[2],pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:a[2]},{label:r[3],fillColor:"rgba(22, 160, 133, 0.0)",strokeColor:i[3],pointColor:i[3],pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:a[3]},{label:r[4],fillColor:"rgba(22, 160, 133, 0.0)",strokeColor:i[4],pointColor:i[4],pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:a[4]},{label:r[5],fillColor:"rgba(22, 160, 133, 0.0)",strokeColor:i[5],pointColor:i[5],pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:a[5]},{label:r[6],fillColor:"rgba(22, 160, 133, 0.0)",strokeColor:i[6],pointColor:i[6],pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:a[6]},{label:r[7],fillColor:"rgba(22, 160, 133, 0.0)",strokeColor:i[7],pointColor:i[7],pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:a[7]},{label:r[8],fillColor:"rgba(22, 160, 133, 0.0)",strokeColor:i[8],pointColor:i[8],pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:a[8]},{label:r[9],fillColor:"rgba(22, 160, 133, 0.0)",strokeColor:i[9],pointColor:i[9],pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:a[9]}]},n=$("#line-chart").get(0).getContext("2d");lineChart=new Chart(n).Line(l,e),$("#line-chart-container").append(lineChart.generateLegend())};